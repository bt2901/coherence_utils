in mathematics the four color theorem or the four color map theorem states that given any separation of a plane into contiguous regions called a map the regions can be colored using at most four colors so that no two adjacent regions have the same color two regions are called adjacent only if they share a border segment not just a point

three colors are adequate for simpler maps but an additional fourth color is required for some maps such as a map in which one region is surrounded by an odd number of other regions that touch each other in a cycle the five color theorem which has a short elementary proof states that five colors suffice to color a map and was proven in the late 19th century however proving four colors suffice turned out to be significantly harder a number of false proofs and false counterexamples have appeared since the first statement of the four color theorem in 1852

despite the motivation from coloring political maps of countries the theorem is not of particular interest to mapmakers according to an article by the math historian kenneth may  “maps utilizing only four colours are rare and those that do usually require only three books on cartography and the history of mapmaking do not mention the four color property”

the four color theorem was proven in 1976 by kenneth appel and wolfgang haken it was the first major theorem to be proven using a computer appel and hakens approach started by showing there is a particular set of 1936 maps each of which cannot be part of a smallest sized counterexample to the four color theorem appel and haken used a special purpose computer program to check each of these maps had this property additionally any map regardless of whether it is a counterexample or not must have a portion that looks like one of these 1936 maps to show this required hundreds of pages of hand analysis appel and haken concluded that no smallest counterexamples existed because any must contain yet not contain one of these 1936 maps this contradiction means there are no counterexamples at all and the theorem is true initially their proof was not accepted by all mathematicians because the computer assisted proof was infeasible for a human to check by hand  since then the proof has gained wider acceptance although doubts remain 

to dispel remaining doubt about the appel–haken proof a simpler proof using the same ideas and still relying on computers was published in 1997 by robertson sanders seymour and thomas additionally in 2005 the theorem was proven by georges gonthier with general purpose theorem proving software

precise formulation of the theorem

the intuitive statement of the four color theorem needs to be interpreted appropriately to be correct for example each region of the map should be contiguous

in the real world not all countries are contiguous eg alaska as part of the united states nakhchivan as part of azerbaijan and kaliningrad as part of russia because the territory of a particular country must be the same color four colors may not be sufficient for instance consider a simplified map

in this map the two regions labeled a belong to the same country and must be the same color this map then requires five colors since the two a regions together are contiguous with four other regions each of which is contiguous with all the others if a consisted of three regions six or more colors might be required one can construct maps that require an arbitrarily high number of colors

some clarification is also needed on when two regions are said to be adjacent for the theorem to be correct two regions should only be considered adjacent if they share a nonzero length of boundary touching at a single boundary point such as the point at four corners where arizona colorado new mexico and utah meet does not count as an adjacency for the purposes of the theorem

to precisely state the theorem it is easiest to rephrase it in graph theory it then states that the vertices of every planar graph can be colored with at most four colors so that no two adjacent vertices receive the same color or every planar graph is four colorable for short   such a graph can be obtained from a map by replacing every region by a vertex and connecting two vertices by an edge exactly when the two regions share a border segment not just a corner

history

early proof attempts

the conjecture was first proposed in 1852 when francis guthrie while trying to color the map of counties of england noticed that only four different colors were needed at the time guthries brother fredrick was a student of augustus de morgan at university college francis inquired with fredrick regarding it who then took it to de morgan francis guthrie graduated later in 1852 and later became a professor of mathematics in south africa according to de morgan

a student of mine guthrie asked me to day to give him a reason for a fact which i did not know was a fact — and do not yet he says that if a figure be any how divided and the compartments differently coloured so that figures with any portion of common boundary line are differently coloured — four colours may be wanted but not more — the following is his case in which four colours are wanted query cannot a necessity for five or more be invented…

the first published reference is by arthur cayley who in turn credits the conjecture to de morgan 

there were several early failed attempts at proving the theorem one proof was given by alfred kempe in 1879 which was widely acclaimed another was given by peter guthrie tait in 1880 it was not until 1890 that kempes proof was shown incorrect by percy heawood and 1891 taits proof was shown incorrect by julius petersen — each false proof stood unchallenged for 11 years 

in 1890 in addition to exposing the flaw in kempes proof heawood proved the five color theorem

significant results were produced by croatian mathematician danilo blanuša in the 1940s by finding an original snark in 1943 hugo hadwiger formulated the hadwiger conjecture a far reaching generalization of the four color problem that still remains unsolved

proof by computer

during the 1960s and 1970s german mathematician heinrich heesch developed methods of using computers to search for a proof notably he was the first to use discharging for proving the theorem which turned out to be important in the unavoidability portion of the subsequent appel haken proof he also expanded on the concept of reducibility and along with ken durre developed a computer test for it unfortunately at this critical juncture he was unable to procure the necessary supercomputer time to continue his work 

others took up his methods and his computer assisted approach in 1976 while other teams of mathematicians were racing to complete proofs kenneth appel and wolfgang haken at the university of illinois announced that they had proven the theorem they were assisted in some algorithmic work by john a koch 

if the four color conjecture were false there would be at least one map with the smallest possible number of regions that requires five colors the proof showed that such a minimal counterexample cannot exist through the use of two technical concepts   

an unavoidable set contains regions such that every map must have at least one region from this collection

a reducible configuration is an arrangement of countries that cannot occur in a minimal counterexample if a map contains a reducible configuration and the rest of the map can be colored with four colors then the entire map can be colored with four colors and so this map is not minimal

using mathematical rules and procedures based on properties of reducible configurations appel and haken found an unavoidable set of reducible configurations thus proving that a minimal counterexample to the four color conjecture could not exist their proof reduced the infinitude of possible maps to 1936 reducible configurations later reduced to 1476 which had to be checked one by one by computer and took over a thousand hours this reducibility part of the work was independently double checked with different programs and computers however the unavoidability part of the proof was verified in over 400 pages of microfiche which had to be checked by hand 

appel and hakens announcement was widely reported by the news media around the world and the math department at the university of illinois used a postmark stating four colors suffice at the same time the unusual nature of the proof it was the first major theorem to be proven with extensive computer assistance and the complexity of the human verifiable portion aroused considerable controversy 

in the early 1980s rumors spread of a flaw in the appel haken proof ulrich schmidt at rwth aachen examined appel and hakens proof for his masters thesis  he had checked about 40 of the unavoidability portion and found a significant error in the discharging procedure  in 1986 appel and haken were asked by the editor of mathematical intelligencer to write an article addressing the rumors of flaws in their proof they responded that the rumors were due to a misinterpretation of schmidts results and obliged with a detailed article  their magnum opus a book claiming a complete and detailed proof with a microfiche supplement of over 400 pages appeared in 1989 and explained schmidts discovery and several further errors found by others 

simplification and verification

since the proving of the theorem efficient algorithms have been found for 4 coloring maps requiring only on2 time where n is the number of vertices in 1996 neil robertson daniel p sanders paul seymour and robin thomas created a quadratic time algorithm improving on a quartic algorithm based on appel and haken’s proof  this new proof is similar to appel and hakens but more efficient because it reduced the complexity of the problem and required checking only 633 reducible configurations both the unavoidability and reducibility parts of this new proof must be executed by computer and are impractical to check by hand 

in 2005 benjamin werner and georges gonthier formalized a proof of the theorem inside the coq proof assistant this removed the need to trust the various computer programs used to verify particular cases it is only necessary to trust the coq kernel 

summary of proof ideas

the following discussion is a summary based on the introduction to appel and hakens book every planar map is four colorable  although flawed kempes original purported proof of the four color theorem provided some of the basic tools later used to prove it the explanation here is reworded in terms of the modern graph theory formulation above

kempes argument goes as follows first if planar regions separated by the graph are not triangulated ie do not have exactly three edges in their boundaries we can add edges without introducing new vertices in order to make every region triangular including the unbounded outer region if this triangulated graph is colorable using four colors or less so is the original graph since the same coloring is valid if edges are removed so it suffices to prove the four color theorem for triangulated graphs to prove it for all planar graphs and from now on we assume the graph is triangulated

suppose v e and f are the number of vertices edges and regions eulers formula states v − e  f  2 this together with the fact that each edge is shared by two regions 2e  3f can be used to show 6v − 2e  12 now the degree of a vertex is the number of edges abutting it if vn is the number of vertices of degree n and d is the maximum degree of any vertex

6v 2e  6sumi1d vi sumi1d ivi  sumi1d 6 ivi  12

but since 12  0 and 6 − i ≤ 0 for all i ≥ 6 this demonstrates that there is at least one vertex of degree 5 or less

if there is a graph requiring 5 colors then there is a minimal such graph where removing any vertex makes it four colorable call this graph g g cannot have a vertex of degree 3 or less because if dv ≤ 3 we can remove v from g four color the smaller graph then add back v and extend the four coloring to it by choosing a color different from its neighbors

kempe also showed correctly that g can have no vertex of degree 4 as before we remove the vertex v and four color the remaining vertices if all four neighbors of v are different colors say red green blue and yellow in clockwise order we look for an alternating path of vertices colored red and blue joining the red and blue neighbors such a path is called a kempe chain there may be a kempe chain joining the red and blue neighbors and there may be a kempe chain joining the green and yellow neighbors but not both since these two paths would necessarily intersect and the vertex where they intersect cannot be colored suppose it is the red and blue neighbors that are not chained together explore all vertices attached to the red neighbor by red blue alternating paths and then reverse the colors red and blue on all these vertices the result is still a valid four coloring and v can now be added back and colored red

this leaves only the case where g has a vertex of degree 5 but kempes argument was flawed for this case heawood noticed kempes mistake and also observed that if one was satisfied with proving only five colors are needed one could run through the above argument changing only that the minimal counterexample requires 6 colors and use kempe chains in the degree 5 situation to prove the five color theorem

in any case to deal with this degree 5 vertex case requires a more complicated notion than removing a vertex rather the form of the argument is generalized to considering configurations which are connected subgraphs of g with the degree of each vertex in g specified for example the case described in degree 4 vertex situation is the configuration consisting of a single vertex labelled as having degree 4 in g as above it suffices to demonstrate that if the configuration is removed and the remaining graph four colored then the coloring can be modified in such a way that when the configuration is re added the four coloring can be extended to it as well a configuration for which this is possible is called a reducible configuration if at least one of a set of configurations must occur somewhere in g that set is called unavoidable the argument above began by giving an unavoidable set of five configurations a single vertex with degree 1 a single vertex with degree 2  a single vertex with degree 5 and then proceeded to show that the first 4 are reducible to exhibit an unavoidable set of configurations where every configuration in the set is reducible would prove the theorem

because g is triangular the degree of each vertex in a configuration is known and all edges internal to the configuration are known the number of vertices in g adjacent to a given configuration is fixed and they are joined in a cycle these vertices form the ring of the configuration a configuration with k vertices in its ring is a k ring configuration and the configuration together with its ring is called the ringed configuration as in the simple cases above one may enumerate all distinct four colorings of the ring any coloring that can be extended without modification to a coloring of the configuration is called initially good for example the single vertex configuration above with 3 or less neighbors were initially good in general the surrounding graph must be systematically recolored to turn the rings coloring into a good one as was done in the case above where there were 4 neighbors for a general configuration with a larger ring this requires more complex techniques because of the large number of distinct four colorings of the ring this is the primary step requiring computer assistance

finally it remains to identify an unavoidable set of configurations amenable to reduction by this procedure the primary method used to discover such a set is the method of discharging the intuitive idea underlying discharging is to consider the planar graph as an electrical network initially positive and negative electrical charge is distributed amongst the vertices so that the total is positive

recall the formula above

sumi1d 6 ivi  12

each vertex is assigned an initial charge of 6 degv then one flows the charge by systematically redistributing the charge from a vertex to its neighboring vertices according to a set of rules the discharging procedure since charge is preserved some vertices still have positive charge the rules restrict the possibilities for configurations of positively charged vertices so enumerating all such possible configurations gives an unavoidable set

as long as some member of the unavoidable set is not reducible the discharging procedure is modified to eliminate it while introducing other configurations appel and hakens final discharging procedure was extremely complex and together with a description of the resulting unavoidable configuration set filled a 400 page volume but the configurations it generated could be checked mechanically to be reducible verifying the volume describing the unavoidable configuration set itself was done by peer review over a period of several years

a technical detail not discussed here but required to complete the proof is immersion reducibility

false disproofs

the four color theorem has been notorious for attracting a large number of false proofs and disproofs in its long history at first the new york times refused as a matter of policy to report on the appel–haken proof fearing that the proof would be shown false like the ones before it  some alleged proofs like kempes and taits mentioned above stood under public scrutiny for over a decade before they were exposed but many more authored by amateurs were never published at all





this map has been colored with five colorsbut it is necessary to change at least four of the ten regions to obtain a coloring with only four colors





generally the simplest though invalid counterexamples attempt to create one region which touches all other regions this forces the remaining regions to be colored with only three colors because the four color theorem is true this is always possible however because the person drawing the map is focused on the one large region they fail to notice that the remaining regions can in fact be colored with three colors

this trick can be generalized there are many maps where if the colors of some regions are selected beforehand it becomes impossible to color the remaining regions without exceeding four colors a casual verifier of the counterexample may not think to change the colors of these regions so that the counterexample will appear as though it is valid

perhaps one effect underlying this common misconception is the fact that the color restriction is not transitive a region only has to be colored differently from regions it touches directly not regions touching regions that it touches if this were the restriction planar graphs would require arbitrarily large numbers of colors

other false disproofs violate the assumptions of the theorem in unexpected ways such as using a region that consists of multiple disconnected parts or disallowing regions of the same color from touching at a point

generalizations

one can also consider the coloring problem on surfaces other than the plane  the problem on the sphere or cylinder is equivalent to that on the plane for closed orientable or non orientable surfaces with positive genus the maximum number p of colors needed depends on the surfaces euler characteristic χ according to the formula

pleftlfloorfrac7  sqrt49 24 chi2rightrfloor

where the outermost brackets denote the floor function



alternatively for an orientable surface the formula can be given in terms of the genus of a surface g

pleftlfloorfrac7  sqrt1  48g 2rightrfloor 

this formula the heawood conjecture was conjectured by pj heawood in 1890 and proven by gerhard ringel and j t w youngs in 1968 the only exception to the formula is the klein bottle which has euler characteristic 0 hence the formula gives p  7 and requires 6 colors as shown by p franklin in 1934

for example the torus has euler characteristic χ  0 and genus g  1 and thus p  7 so no more than 7 colors are required to color any map on a torus

a möbius strip also requires six colors 

there is no obvious extension of the coloring problem to three dimensional solid regions by using a set of n flexible rods one can arrange that every rod touches every other rod the set would then require n colors or n1 if you consider the empty space that also touches every rod the number n can be taken to be any integer as large as desired such examples were known to fredrick gurthrie in 1880 

see also

graph coloring the problem of finding optimal colorings of graphs that are not necessarily planar

hadwiger–nelson problem how many colors are needed to color the plane so that no two points at unit distance apart have the same color

references

























external links

wikibooksamateurs guide to proving the four color theorem

the four color problem gets a sharp new hue